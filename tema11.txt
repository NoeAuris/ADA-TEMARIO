PEP8 - Practica - Trabajo Final
Ejercicios y dudas clase pasada
PEP8
Ya estamos programando en Python, ahora queda hacerlo de la mejor forma. La PEP8 es una gu칤a que indica las convenciones estil칤sticas a seguir para escribir c칩digo Python. Se trata de un conjunto de recomendaciones cuyo objetivo es ayudar a escribir c칩digo m치s legible y abarca desde c칩mo nombrar variables, al n칰mero m치ximo de caracteres que una l칤nea debe tener.

Dos mismos c칩digos pueden realizar lo mismo funcionalmente, pero si no se siguen unas directrices estil칤sticas, se puede acabar teniendo un c칩digo muy dif칤cil de leer. Los problemas m치s frecuentes suelen ser:

L칤neas demasiado largas.

Nombres de variables poco explicativos.

C칩digo mal comentado.

Uso incorrecto de espacios y l칤neas en blanco.

C칩digo mal identado.

Aunque es cierto que ciertas directrices pueden resultar arbitrarias, Python define en la PEP8 las normas estil칤sticas a seguir para cualquier c칩digo parte de la librer칤a est치ndar, por lo que queda al criterio de cada uno usar estas recomendaciones o no. Sin embargo, pr치cticamente cualquier c칩digo o librer칤a usado por gran cantidad de personas, emplea estas recomendaciones, al haber un amplio consenso en la comunidad.

Formatear C칩digo Python PEP8
A veces puede resultar complicado acordarnos de todas y cada una de las normas de la PEP8, por lo que hay herramientas que nos ayudan a corregir autom치ticamente o indicarnos donde hay problemas en nuestro c칩digo.

PyCharm
En este curso decidimos utilizar pyCharm, el cual tiene integrado el analisis de PEP8 y nos resalta con un subrayado en amarillo los posibles problemas que tenemos en nuestro c칩digo.

Organizaci칩n del c칩digo - L칤neas en Blanco
Aunque Pycharm puede alertarnos, necesitamos entender cuales son las reglas para darnos cuenta instantaneamente del error.

El uso de l칤neas en blanco mejora notablemente la legibilidad. Mucho c칩digo seguido puede ser dif칤cil de leer, pero un uso excesivo de l칤neas en blanco puede ser molesto. Python deja su uso a nuestro criterio, siempre y cuando cumplamos lo siguiente:

Rodear las funciones y clases con dos l칤neas en blanco. Cada vez que definamos una clase o una funci칩n es necesario dejar dos l칤neas en blanco por arriba y dos por abajo.

Dejar una l칤nea en blanco entre los m칠todos de una clase. Los m칠todos de una clase deber치n tener una l칤nea en blanco entre ellos.

Usar l칤neas en blanco para agrupar pasos similares. Si tenemos un conjunto de c칩digo que realiza una funci칩n concreta, es conveniente delimitarlo con una l칤nea en blanco, de la misma manera que un libro separa ideas en p치rrafos.

ejemplo:

class ClaseA:
    def metodo_a(self):
        pass  # pass es una palabra reservada que indica que no vamos a proporcionar la implementaci칩n

    def metodo_b(self):
        pass


class ClaseB:
    def metodo_a(self):
        pass

    def metodo_b(self):
        pass


def funcion():
    pass


def calcula_media_mediana(valores):
    # Calculamos la media
    suma_valores = 0
    for valor in valores:
        suma_valores += valor
    media = suma_valores / len(valores)
    
    # Calculamos la mediana
    valores_ordenados = sorted(valores)
    indice = len(valores) // 2
    if len(valores) % 2:
        mediana = valores_ordenados[indice]
    else:
        mediana = (valores_ordenados[indice]
                   + valores_ordenados[indice + 1]) / 2

    return media, mediana


El uso de espacios en blanco puede resultar clave para mejorar la legibilidad de nuestro c칩digo, y es por lo que la PEP8 nos dice d칩nde debemos usar espacios y d칩nde no. Se trata de buscar un punto de equilibrio entre un c칩digo demasiado disperso y con gran cantidad de espacios, y un c칩digo demasiado junto donde no se identifican sus partes.

Organizaci칩n del c칩digo - Espacios en Blanco
Se nos recomienda usar espacio con operadores de asignaci칩n.

# Correcto
x = 5

# Incorrecto
x=5

# Y tambi칠n con operadores relacionales.

# Correcto
if x == 5:
    pass

# Incorrecto
if x==5:
    pass

ojo: Pero cuando tengamos funciones con argumentos por defecto, no debemos dejar espacios.

# Correcto
def mi_funcion(parameto_por_defecto=5):
    print(parameto_por_defecto)

# Incorrecto
def mi_funcion(parameto_por_defecto = 5):
    print(parameto_por_defecto)

Por otro lado se recomienda no dejar espacios dentro del par칠ntesis.

def duplica(a):
    return a * 2

# Correcto
duplica(2)

# Incorrecto
duplica( 2 )

# Y tampoco entre corchetes.

# Correcto
lista = [1, 2, 3]

# Incorrecto
my_list = [ 1, 2, 3, ]

No usar espacio antes de , en llamadas a funciones o m칠todos.

# Correcto
print(x, y)

# Incorrecto
print(x , y)

# Cuando usemos listas no usar espacios antes del 칤ndice o entre el 칤ndice y los [].

# Correcto
lista[0]

# Incorrecto
lista [1]

# Incorrecto
lista [ 1 ]

# Tampoco usando diccionarios.

# Correcto
diccionario['key'] = lista[indice]

# Incorrecto
diccionario ['key'] = lista [indice]


Por 칰ltimo y aunque pueda parecer raro para la gente que venga de otros lenguajes de programaci칩n, no se recomienda alinear las variables como se muestra a continuaci칩n.

# Correcto
var_a = 0
variable_b = 10
otra_variable_c = 3

# Incorrecto
var_a           = 0
variable_b      = 10
otra_variable_c = 3

Identaci칩n del c칩digo Como ya hemos visto, Python no usa {} para designar bloques de c칩digo como otros lenguajes de programaci칩n, sino que usa bloques identados para indicar que un determinado bloque de c칩digo pertenece a por ejemplo un if.

if x > 5:
    pass

Un bloque identado se representa usando cuatro espacios y aunque el uso del tabulador pueda parecer lo mismo, Python 3 no recomienda su uso. Como regla de oro:

Usa siempre cuatro espacios.
Usa tabuladores si trabajas sobre c칩digo ajeno que ya use tabuladores.
Bajo ning칰n concepto mezcles uso de espacios y tabuladores.
Por otro lado, tambi칠n se puede identar el c칩digo para evitar tener l칤neas muy largas, que resultan dif칤ciles de leer. Es importante recordar que la PEP8 limita el tama침o de l칤nea a 79 caracteres.
# Correcto
def mi_funcion(primer_parametro, segundo_parametro,
               tercer_parametro, cuarto_parametro,
               quinto_parametro):
    print("Python")

# Incorrecto
def mi_funcion(primer_parametro, segundo_parametro, tercer_parametro, cuarto_parametro, quinto_parametro):
    print("Python")

#Lo siguiente ser칤a incorrecto ya que no se diferencian los argumentos de entrada del bloque de c칩digo a ejecutar por la funci칩n.

# Incorrecto
def mi_funcion(primer_parametro, segundo_parametro,
    tercer_parametro, cuarto_parametro,
    quinto_parametro):
    print("Python")

# An치logamente se puede romper un if en diferentes l칤neas, 칰til cuando se usan gran cantidad de condiciones que no entran una una l칤nea.

# Correcto
if (condicion_a and
        condicion_b):
    print("Python")



Organizaci칩n del c칩digo - Tama침o de linea
Se recomienda limitar el tama침o de cada l칤nea a 79 caracteres, para evitar tener que hacer scroll a la derecha. Este l칤mite tambi칠n permite tener abiertos m칰ltiples ficheros en la misma pantalla, uno al lado de otro. Por otro lado se limita el uso de docstrings y comentarios a 72 caracteres.

En los casos que tengamos una l칤nea que no sea posible romper, podemos usar \ para continuar con la l칤nea en una nueva. Esto es algo que a veces puede darse en los context managers.

# Correcto
with open('/esta/ruta/es/muy/pero/que/muy/larga/y/no/entra/en/una/sola/linea/') as fichero_1, \
     open('/esta/ruta/es/muy/pero/que/muy/larga/y/no/entra/en/una/sola/linea/', 'w') as fichero_2:
    fichero_2.write(fichero_1.read())


Si queremos realizar una operaci칩n muy larga que no entra en una l칤nea, tendremos que dividirla en m칰ltiples. Lo recomendado es usar el operador al principio de cada l칤nea, ya que resulta mas f치cil de leer.

# Recomendado
income = (variable_a
          + variable_b
          + (variable_c - variable_d)
          - variable_e
          - variable_f)

# La siguiente opci칩n no es recomendada pero la PEP8 tampoco la proh칤be.

# No recomendado
income = (variable_a +
          variable_b +
          (variable_c - variable_d) -
          variable_e -
          variable_f)


Codificaci칩n de ficheros
Los ficheros se codifican por defecto en ASCII para Python 2 y UTF-8 para Python 3, por lo que ser치 necesario definir la codificaci칩n que usemos cuando queramos usar otro tipo.

Esto resulta muy importante, ya que si queremos almacenar una cadena que contiene caracteres no UTF-8 como 칩 y 침, deberemos especificar el tipo de encoding de acuerdo a la PEP263. El siguiente c칩digo puede dar problemas.

# En Python2
print("La acentuaci칩n del Espa침ol")
# SyntaxError: Non-ASCII character '\xe2' in file .../main.py on line 5, but no encoding declared; see http://python.org/dev/peps/pep-0263/ for details


Sin embargo, con un peque침o cambio, podemos cambiar la forma en la que se codifica el texto.

# -*- coding: utf-8 -*-
print("La acentuaci칩n del Espa침ol")
# La acentuaci칩n del Espa침ol

Trabajo Final
Teniendo en cuenta todo lo anterior, vamos a crear nuestro primer proyecto oficial en Python. Ver [ejercicios clase 11] para leer la primera parte del Trabajo Final.

Nuevo Proyecto
Empezamos por crear un nuevo proyecto en PyCharm:

Debemos fijarnos si nos creo el venv, sino:

Vamos al menu superior -> Settings -> y buscamos 'Interpreter'

Arriba a la derecha del PyCharm, nos fijamos si est치 el VirtualEnv:

Luego debemos crear el repo en GitHub:

Luego debemos subir el repo:

Requirements
Creamos un nuevo file que se va a llamar requirements.txt

En este file iremos agregando las librerias que vamos a utilizar. En principio, la primer libreria que necesitamos es flask.

lask

Estructura de carpetas

app.py
static
templates

Ejercicios anteriores
Al proyecto, agregamos nuestro log.py y proceso_cuentas.py

Servidor
Al proyecto agregamos app.py con el siguiente contenido:

# import the Flask class from the flask module
from flask import Flask, render_template

# create the application object
app = Flask(__name__)

# use decorators to link the function to a url
@app.route('/')
def home():
    return "Hello, World!"  # return a string

@app.route('/welcome')
def welcome():
    return render_template('welcome.html')  # render a template

# start the server with the 'run()' method
if __name__ == '__main__':
    app.run(debug=True)


dentro de la carpeta templates agregar welcome.html con el siguiente contenido:

<HTML>Solo dice WELCOME</HTML>s

游 Recursos de la clase
https://ellibrodepython.com/python-pep8

https://blog.carreralinux.com.ar/2021/08/crear-un-nuevo-repositorio-con-git/

Libro entero de Python con Flask (en ingles): https://www.oreilly.com/library/view/flask-web-development/9781491991725/
